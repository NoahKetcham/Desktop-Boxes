<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Boxes.App.ViewModels"
        x:Class="Boxes.App.Views.TaskbarBoxWindow"
        x:DataType="vm:TaskbarBoxWindowViewModel"
        Width="320"
        Height="240"
        MinHeight="40"
        CanResize="True"
        CanMinimize="False"
        CanMaximize="False"
        WindowStartupLocation="Manual"
        SystemDecorations="BorderOnly"
        TransparencyLevelHint="Transparent"
        Background="Transparent">

    <Grid x:Name="RootGrid" Background="#1C2235" ClipToBounds="True"
          DragDrop.AllowDrop="True"
          DragDrop.DragEnter="Content_OnDragEnter"
          DragDrop.DragOver="Content_OnDragOver"
          DragDrop.Drop="Content_OnDrop">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border x:Name="HeaderBar" Grid.Row="1" Background="#232B46" Padding="12" MinHeight="40" Cursor="Hand" UseLayoutRounding="True" RenderOptions.EdgeMode="Aliased"
                PointerPressed="Header_OnPointerPressed" PointerMoved="Header_OnPointerMoved" PointerReleased="Header_OnPointerReleased">
            <TextBlock Text="{Binding Name}"
                       FontSize="16"
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       TextWrapping="NoWrap"
                       TextTrimming="CharacterEllipsis"/>
        </Border>

        <Border x:Name="ContentArea" Grid.Row="0" Padding="12" IsVisible="{Binding IsExpanded}">
            <StackPanel Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <Button Content="Home" Command="{Binding NavigateHomeCommand}"/>
                    <Button Content="Up" Command="{Binding NavigateUpCommand}"/>
                    <TextBlock Text="{Binding CurrentPath}" VerticalAlignment="Center"/>
                </StackPanel>
                <ItemsControl ItemsSource="{Binding CurrentItems}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel ItemWidth="96" ItemHeight="96" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="vm:DesktopFileViewModel">
                        <Border Width="96" Height="96" Background="Transparent" Margin="8" Cursor="Hand" DoubleTapped="Shortcut_OnDoubleTapped">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="6">
                                <Border Width="48" Height="48" Background="#101627" CornerRadius="4" HorizontalAlignment="Center">
                                    <Image Source="{Binding Icon}" Width="48" Height="48" Stretch="Uniform"/>
                                </Border>
                                <TextBlock Text="{Binding DisplayName}" TextWrapping="Wrap" TextAlignment="Center" MaxWidth="96" FontSize="12"/>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>

        <!-- Resize handles active only when expanded -->
        <Border Tag="Left" HorizontalAlignment="Left" VerticalAlignment="Stretch" Width="6" Background="Transparent"
                IsHitTestVisible="{Binding IsExpanded}"
                PointerPressed="ResizeHandle_OnPointerPressed"/>
        <Border Tag="Right" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="6" Background="Transparent"
                IsHitTestVisible="{Binding IsExpanded}"
                PointerPressed="ResizeHandle_OnPointerPressed"/>
        <Border Tag="Top" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="6" Background="Transparent"
                IsHitTestVisible="{Binding IsExpanded}"
                PointerPressed="ResizeHandle_OnPointerPressed"/>
        <Border Tag="TopLeft" HorizontalAlignment="Left" VerticalAlignment="Top" Width="12" Height="12" Background="Transparent"
                IsHitTestVisible="{Binding IsExpanded}"
                PointerPressed="ResizeHandle_OnPointerPressed"/>
        <Border Tag="TopRight" HorizontalAlignment="Right" VerticalAlignment="Top" Width="12" Height="12" Background="Transparent"
                IsHitTestVisible="{Binding IsExpanded}"
                PointerPressed="ResizeHandle_OnPointerPressed"/>
    </Grid>

</Window>


